## Лаба 6. Подсчёт статистики по фильмам

##### [![New Professions Lab — Big Data 10](http://data.newprolab.com/public-newprolab-com/npl7.svg)](https://github.com/newprolab/content_bigdata10)

### Дедлайн

⏰  Четверг, 23 мая 2019 года, 23:59.

### Задача

По имеющимся данным о рейтингах фильмов (MovieLens: 100 000 рейтингов) посчитать агрегированную статистику по ним.

#### Обработка данных на вход

Имеются следующие входные данные:
* Таблица `users * films` с рейтингами. Архив с датасетом нужно скачать с сайта GroupLens: http://files.grouplens.org/datasets/movielens/ml-100k.zip. Также, он загружен на HDFS в /labs/lab06data/ml-100k. Файл `u.data` содержит все оценки, а файл `u.item` — список всех фильмов.
* `id` фильма для расчета индивидуальных характеристик — в вашем Личном кабинете на странице [Лабы 6](http://lk.newprolab.com/lab/laba06).

#### Обработка данных на выход

Для выданного `id` фильма: 
1. Построить распределения оценок. Получится таблица, где в первом столбце стоят значения оценки `1,2,3,4,5`, а во втором — количество человек, поставивших соответствующую оценку. Поле должно называться `“hist_film”`.
2. Чтобы понять какие оценки предпочитают ставить пользователи MovieLens, постройте аналогичное предыдущему пункту распределение оценок, но только уже для всего датасета. Поле должно называться `“hist_all”`.

Файл с решением должен содержать *только значения* распределения оценок `1,2,3,4,5` из вашей полученной таблицы. 

В поле `“hist_film”` нужно указать в следующем порядке для заданного `id` фильма  количество поставленных оценок: `1,2,3,4,5`.

В поле `“hist_all”` нужно указать в следующем порядке для всех фильмов общее количество поставленных оценок: `1,2,3,4,5`.

Выходной формат — json. Пример решения:

```
{
   "hist_film": [  
      134,
      123,
      782,
      356,
      148
   ],
   "hist_all": [  
      134,
      123,
      782,
      356,
      148
   ]
}
```

### Проверка

Файл необходимо положить в свою домашнюю директорию под названием: `lab06.json`.

Проверка осуществляется [автоматическим скриптом](http://lk.newprolab.com/lab/laba06) из Личного кабинета.

